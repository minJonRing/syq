<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link rel="stylesheet" href="/stylesheets/table.css">
    <script src="/javascripts/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.14.1/lodash.min.js"></script>
    <script src="/javascripts/jquery-3.3.1.min.js"></script>
    <script src="/set.config.js"></script>
    <script src="/web.config.js"></script>
    <style>
        .list-complete-item {
            transition: all 1000ms;
            display: inline-block;
            margin-right: 10px;
        }
        
        .list-complete-enter,
        .list-complete-leave-to {
            opacity: 0;
            transform: translateY(30px);
        }
        
        .list-complete-leave-active {
            position: absolute;
        }
        
        .set-nav {
            display: flex;
            align-items: center;
            justify-content: space-around;
            padding: 0 24px;
        }
        
        .set-nav .input-box {
            position: relative;
            margin: 0 12px;
        }
        
        .set-nav .input-box input[type=text] {
            width: 100%;
        }
        
        .add-item {
            position: absolute;
            padding: 0 4px;
            right: 0;
            color: #000;
            border: 1px #ddd solid;
            border-radius: 3px;
            font-size: 18px;
            transition-duration: 600ms;
        }
        
        .add-item:hover {
            color: rgb(14, 141, 2);
            background-color: #f5f5f5;
        }
        
        .item-option {
            position: absolute;
            display: flex;
            top: 100%;
            left: 0;
            width: 100%;
            border: 1px #ddd solid;
            border-radius: 5px;
            pointer-events: none;
            transform: matrix(1, 0, 0, 1, 20, 0);
            opacity: 0;
            transition-duration: 600ms;
        }
        
        .item-option a {
            width: 50%;
            padding: 12px 0;
            color: #000;
            text-align: center;
            opacity: .6;
            transition-duration: 600ms;
        }
        
        .item-option a:first-child {
            background-color: rgb(4, 104, 197);
            border-right: 1px #000 solid;
            position: relative;
            border-top-left-radius: 3px;
            border-bottom-left-radius: 3px;
        }
        
        .item-option a:last-child {
            background-color: rgb(4, 158, 68);
            border-top-left-radius: 3px;
            border-bottom-right-radius: 3px;
        }
        
        .item-option a:hover {
            opacity: 1;
        }
        
        .selectswop {
            position: absolute;
            width: 100%;
            top: 100%;
            left: 0;
            border-left: 1px #ddd solid;
            border-right: 1px #ddd solid;
            border-radius: 3px;
            opacity: 0;
            transform: matrix(1, 0, 0, 1, 20, 0);
            pointer-events: none;
            transition-duration: 600ms;
        }
        
        .showselectswop {
            opacity: 1;
            transform: matrix(1, 0, 0, 1, 0, 0);
            pointer-events: auto;
        }
        
        .selectswop i {
            display: block;
            width: 100%;
            padding: 6px;
            border-bottom: 1px #ddd solid;
            transition-duration: 600ms;
        }
        
        .selectswop i:hover {
            color: dodgerblue;
            background-color: #ddd;
        }
        
        .show-item-option {
            opacity: 1;
            pointer-events: auto;
            transform: matrix(1, 0, 0, 1, 0, 0);
        }
    </style>
</head>

<body>
    <div id="app">
        <a href="javascript:" @click="bindWrite">保存</a>

        <button v-on:click="shuffle">Shuffle</button>
        <button v-on:click="add">Add</button>
        <button v-on:click="remove">Remove</button>
        <button v-on:click="shuffle1">www</button>
        <transition-group name="list-complete" tag="p">
            <span v-for="item in items" :key="item" class="list-complete-item">
                {{ item }}
            </span>
        </transition-group>

        <transition-group class="set-nav" name="list-complete" tag="div">
            <div v-for="(item,index) in navs" :key="item.txt" class="list-complete-item">
                <div class="input-box">
                    <input type="text" v-model="item.txt">
                    <a class="add-item" href="javascript:" @click.stop="bindShowOption($event,index)">+</a>
                    <div :class="['item-option',{'show-item-option':index == zindex}]">
                        <a href="javascript:">
                            <span class="swop" @click.stop="bindShowSwop($event,index)">交换</span>
                            <span :class="['selectswop',{'showselectswop':index == zindex && index == showSwop}]">
                                <i v-for="(item,index) in navs" :key="index" @click="bindSwop($event,index)">{{index}}</i>
                            </span>
                        </a>
                        <a href="javascript:" @click.stop="bidnShowChild">子导航</a>
                    </div>
                </div>

                <ul>
                    <li></li>
                </ul>
            </div>
        </transition-group>
        <a href="javascript:" @click="bindSave">save</a>
    </div>
</body>
<script>
    let app = new Vue({
        el: "#app",
        data: {
            items: [1, 2, 3, 4, 5, 6, 7, 8, 9],
            nextNum: 10,
            navs: set_config.header,
            zindex: -1,
            showSwop: -1,
            showChild: -1
        },
        mounted() {
            // setInterval(() => {
            //     console.log(this.navs)
            // }, 1000);
        },
        methods: {
            /*
             *写入数据
             */
            bindWrite() {
                $.ajax({
                    url: "/app/config",
                    type: "POST",
                    data: {
                        config: "let a = {a: 1,b: 2,c:3}"
                    },
                    success: (res) => {
                        console.log(res)
                    }
                })
            },
            randomIndex: function() {
                return 0
            },
            add: function() {
                this.items.splice(this.randomIndex(), 0, this.nextNum++)
            },
            remove: function() {
                this.items.splice(this.randomIndex(), 1)
            },
            shuffle: function() {
                this.navs = _.shuffle(this.navs)
                console.log(this.navs)
            },
            shuffle1: function() {
                this.items = [1, 2, 6, 4, 5, 8, 7, 9, 3]
            },
            //
            bindShowOption(event, index) {
                this.showSwop = this.showChild = -1;
                if (this.zindex == index) {
                    this.zindex = -1;
                } else {
                    this.zindex = index;
                }
            },
            bindShowSwop(event, index) {
                if (this.showSwop == index) {
                    this.showSwop = -1;
                } else {
                    this.showSwop = index;
                }
            },
            bindSwop(event, index) {
                let arr = [].concat(this.navs);
                let obj = arr[this.zindex];
                arr[this.zindex] = arr[index];
                arr[index] = obj;
                this.navs = arr;
                this.showSwop = this.zindex = -1;
            },
            // 显示子导航
            bidnShowChild(event, index) {

            },
            // 编辑子导航
            bindChild(event, index) {

            },
            //保存
            bindSave() {
                let data = `var tqr = ${JSON.stringify(this.navs)}`;
                console.log(data)
                $.ajax({
                    url: "/app/config",
                    type: "POST",
                    data: {
                        config: data
                    },
                    success: (res) => {
                        console.log(res)
                    }
                })
            }
        }
    })
</script>

</html>